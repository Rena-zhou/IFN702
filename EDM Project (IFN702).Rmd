---
title: 'IFN702: Educational Data Mining project'
output:
  html_document: default
  html_notebook: default
  pdf_document: default
  word_document: default
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
###### version 1.0 --- Zhiying Zhou: 9835580

# Introduction 

This study will process, exploration, analyze and predict Student's academic performance based on a XAPI Educational Mining Datasets. 

The XAPI Educational Mining Datasets is download from the Kaggle website. It was collected from an e-Learning system called Kalboard 360 using Experience API Web service (XAPI).

The datasets consist of 480 student records and 16 features. The features are classified into three major categories: 
1.	Demographic features such as gender, grade levels, topic and nationality. 
2.	Academic background features such as educational stage, grade Level and section. 
3.	Behavioral features such as raised hand on class, opening resources, answering survey by parents, and school satisfaction.

The students are classified into three numerical intervals based on their total grade/mark:

Low-Level: interval includes values from 0 to 69,
Middle-Level: interval includes values from 70 to 89,
High-Level: interval includes values from 90-100.

We will use R Studio to analyze this datasets in R programming language, and aim to achieve the following targets:

1.	Preprocess of the datasets. Clean the dataset, remove the useless columns or rows; and
2.	Explore the datasets. Explore the distribution of the datasets in different features: gender, nationality, grade, topic, parental satisfaction etc. (like girls raises more hand, more discussions in high school etc.); and
3.	Find underlying relationships. Like parent who are not satisfied and not answer survey, connection with study activity and performance (raising hand, discussion, absence, parental satisfaction, answering survey etc.); and
4.	Build prediction model, like decision tree or regression model to predict the student's academic performance.
5.	Evaluate the predictive results of models and improve the models by comparing the accuracy. 


#Task 1.0 


```{r}
# install libraries
library(ggplot2)
library(reshape2)
```

```{r}
# Import Uber pickups data sets
E <- read.csv("data/xAPI-Edu-Data.csv")
E
```

```{r}
str(E)
summary(E)
```

```{r}
ED <- data.frame(Gender=E$gender, Nationality=E$NationalITy, PlaceofBirth=E$PlaceofBirth, StageID=E$StageID, GradeID=E$GradeID, SectionID=E$SectionID, Topic=E$Topic, Semester=E$Semester, Relation=E$Relation, Raisehands=E$raisedhands, VisitedResources=E$VisITedResources, AnnouncementsView=E$AnnouncementsView, Discussion=E$Discussion, ParentAnsweringSurvey=E$ParentAnsweringSurvey, ParentschoolSatisfaction=E$ParentschoolSatisfaction, StudentAbsenceDays=E$StudentAbsenceDays, Class=E$Class)

Gender_frequence <- as.data.frame(table(ED$Gender))
names(Gender_frequence)<- c("Gender","Counts")

ggplot(data=Gender_frequence, aes(x = Gender, y = Counts, fill=Gender))+geom_bar(stat = "identity")+ggtitle(label = "Gender Distribution")+theme_grey()+theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face = "bold"))+xlab("Gender")+ylab("Counts")+ geom_text(aes(label = Counts, vjust = 0), show_guide = FALSE)

Nationality_frequence <- as.data.frame(table(ED$Nationality))
names(Nationality_frequence)<- c("Nationality","Counts")
Nationality_frequence

ggplot(data=Nationality_frequence, aes(x = Nationality, y = Counts, fill=Nationality))+geom_bar(stat = "identity")+ggtitle(label = "Nationality Distribution")+theme_grey()+theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face = "bold"))+xlab("Nationality")+ylab("Counts")+theme(axis.text.x = element_text(angle=90, hjust=1)) + geom_text(aes(label = Counts, vjust = 0), show_guide = FALSE)


```


```{r}

ggplot(E, aes(x = raisedhands)) + geom_histogram(color = "black") +
    scale_x_continuous(breaks = seq(0,100,5)) + 
    labs(x = "Raised Hands", y = "Student Count")

# Extract the data of formated weekdays from the file and use it to analyse the number of Uber pick ups
day1 <- as.data.frame(table(day))
day1
```

```{r}
# Plot the data of Uber pick ups by weekday

ggplot(day1, aes(x = day, y = Freq)) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle=90, hjust=1)) + xlab("Weekdays") + ylab("Counts") + scale_x_discrete(limits=c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"))

#the "scale_x_discrete" above is to order the plotbar in a sequence of weekday
```

```{r}
# Extract the data of formated month from the file and use it to analyse the number of Uber pick ups
month1 <- as.data.frame(table(month))
month1
```

```{r}
# Plot the data of Uber pick ups by month

ggplot(month1, aes(x = month, y = Freq)) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle=90, hjust=1)) + xlab("Months") + ylab("Counts") + scale_x_discrete(limits=c("April","May","June","July","August","September"))

#the "scale_x_discrete" is to order the plotbar in a sequence of month
```


```{r}
# Extract the data of formated time from the file and use it to analyse the number of Uber pick ups
time1 <- as.data.frame(table(time))
time1
```

```{r}
# Plot the data of Uber pick ups by hour
ggplot(time1, aes(x = time, y = Freq)) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle=90, hjust=1)) + xlab("Time") + ylab("Counts")
```


#Task 2.0
```{r}
# Install libraries
library(evaluate)
library(ggmap)
library(mapproj)
```

```{r}
# Sort the file in a sequence of weekday
Uberpickups1$day <- factor(Uberpickups1$day, levels = c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
Uberpickups2 <- Uberpickups1[order(Uberpickups1$day),]
```

```{r}
# Plot the data on a spatial map of task2.1
newyork <- get_map(location = 'New York City', zoom = 13, maptype="roadmap")
Uber.in.us <- ggmap(newyork)
Uber.in.us + geom_point(data=Uberpickups2, aes(x=Lon, y=Lat, color=day), alpha=0.1)
```


```{r}
# Plot the data via density plots of task2.1
newyork <- get_map(location = 'New York City', zoom = 12, maptype="roadmap")
Uber.in.us <- ggmap(newyork)
Uber.in.us + stat_density2d(aes(x=Lon, y=Lat, fill = ..level.., alpha=0.5), size = 4, bins = 4, data = Uberpickups2, geom = "polygon") + facet_wrap(~ day)
```


```{r}
# Sort the file in a sequence of month
Uberpickups1$month <- factor(Uberpickups1$month, levels = c("April","May","June","July","August","September"))
Uberpickups3 <- Uberpickups1[order(Uberpickups1$month),]
```

```{r}
# Plot the data on a spatial map of task2.2
newyork <- get_map(location = 'New York City', zoom = 13, maptype="roadmap")
Uber.in.us <- ggmap(newyork)
Uber.in.us + geom_point(data=Uberpickups3, aes(x=Lon, y=Lat, color=month), alpha=0.5)
```

```{r}
# Plot the data via density plots of task2.2
newyork <- get_map(location = 'New York City', zoom = 12, maptype="roadmap")
Uber.in.us <- ggmap(newyork)
Uber.in.us + stat_density2d(aes(x=Lon, y=Lat, fill = ..level.., alpha=0.5), size = 2, bins = 4, data = Uberpickups3, geom = "polygon") + facet_wrap(~ month)
```


```{r}
# Plot the data on a spatial map of task2.3
newyork <- get_map(location = 'New York City', zoom = 13, maptype="roadmap")
Uber.in.us <- ggmap(newyork)
Uber.in.us + geom_point(data=Uberpickups1, aes(x=Lon, y=Lat, color=time), alpha=0.5)
```

```{r}
# Plot the data via density plots of task2.3
newyork <- get_map(location = 'New York City', zoom = 12, maptype="roadmap")
Uber.in.us <- ggmap(newyork)
Uber.in.us + stat_density2d(aes(x=Lon, y=Lat, fill = ..level.., alpha=0.5), size = 2, bins = 4, data = Uberpickups1, geom = "polygon") + facet_wrap(~ time)
```



