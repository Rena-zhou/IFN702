---
title: 'IFN702: Educational Data Mining project'
output:
  html_document: default
  html_notebook: default
  pdf_document: default
  word_document: default
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
###### version 1.0 --- Zhiying Zhou: 9835580

# Introduction 

This study will process, exploration, analyze and predict Student's academic performance based on a XAPI Educational Mining Datasets. 

The XAPI Educational Mining Datasets is download from the Kaggle website. It was collected from an e-Learning system called Kalboard 360 using Experience API Web service (XAPI).

The datasets consist of 480 student records and 16 features. The features are classified into three major categories: 
1.	Demographic features such as gender, grade levels, topic and nationality. 
2.	Academic background features such as educational stage, grade Level and section. 
3.	Behavioral features such as raised hand on class, opening resources, answering survey by parents, and school satisfaction.

Attributes
1 Gender - student's gender (nominal: 'Male' or 'Female') 
2 Nationality- student's nationality (nominal:' Kuwait',' Lebanon',' Egypt',' SaudiArabia',' USA',' Jordan',' Venezuela',' Iran',' Tunis',' Morocco',' Syria',' Palestine',' Iraq',' Lybia')
3 Place of birth- student's Place of birth (nominal:' Kuwait',' Lebanon',' Egypt',' SaudiArabia',' USA',' Jordan',' Venezuela',' Iran',' Tunis',' Morocco',' Syria',' Palestine',' Iraq',' Lybia')
4 Educational Stages- educational level student belongs (nominal: 'lowerlevel','MiddleSchool','HighSchool') 
5 Grade Levels- grade student belongs (nominal: 'G-01', 'G-02', 'G-03', 'G-04', 'G-05', 'G-06', 'G-07', 'G-08', 'G-09', 'G-10', 'G-11', 'G-12 ') 
6 Section ID- classroom student belongs (nominal:'A','B','C')
7 Topic- course topic (nominal:' English',' Spanish', 'French',' Arabic',' IT',' Math',' Chemistry', 'Biology', 'Science',' History',' Quran',' Geology')
8 Semester- school year semester (nominal:' First',' Second')
9 Parent responsible for student (nominal:'mom','father')
10 Raised hand- how many times the student raises his/her hand on classroom (numeric:0-100)
11- Visited resources- how many times the student visits a course content(numeric:0-100)
12 Viewing announcements-how many times the student checks the new announcements(numeric:0-100)
13 Discussion groups- how many times the student participate on discussion groups (numeric:0-100)
14 Parent Answering Survey- parent answered the surveys which are provided from school or not (nominal:'Yes','No')
15 Parent School Satisfaction- the Degree of parent satisfaction from school(nominal:'Yes','No')
16 Student Absence Days-the number of absence days for each student (nominal: above-7, under-7)

The students are classified into three numerical intervals based on their total grade/mark:

Low-Level: interval includes values from 0 to 69,
Middle-Level: interval includes values from 70 to 89,
High-Level: interval includes values from 90-100.

We will use R Studio to analyze this datasets in R programming language, and aim to achieve the following targets:

1.	Preprocess of the datasets. Clean the dataset, remove the useless columns or rows; and
2.	Explore the datasets. Explore the distribution of the datasets in different features: gender, nationality, grade, topic, parental satisfaction etc. (like girls raises more hand, more discussions in high school etc.); and
3.	Find underlying relationships. Like parent who are not satisfied and not answer survey, connection with study activity and performance (raising hand, discussion, absence, parental satisfaction, answering survey etc.); and
4.	Build prediction model, like decision tree or regression model to predict the student's academic performance.
5.	Evaluate the predictive results of models and improve the models by comparing the accuracy. 


#Task 1. Exporation of the students' academic performance datasets

#Task 1.1. Barplots of classification values distribution:


```{r}
# install libraries
library(ggplot2)
library(reshape2)
library(caret)
library(e1071)
library(randomForest)
library(dplyr)

```

```{r}
# Import Uber pickups data sets
E <- read.csv("data/xAPI-Edu-Data.csv")
E
```

```{r}
str(E)
summary(E)
#levels(E$Class) = c('H','M','L')
E

E$Class = factor(E$Class, levels=c("H","M","L"), labels=c("H","M","L")) 

E$StageID = factor(E$StageID, levels=c("HighSchool","MiddleSchool","lowerlevel"), labels=c("HighSchool","MiddleSchool","Lowerlevel")) 

```


```{r}
ggplot(data = E, aes(x = gender, fill = Relation)) + geom_bar() +
    labs(x = "Gender", y = "Student Count")
```
#Parent responsible for student


```{r}
ggplot(data = E, aes(x = gender, fill = ParentAnsweringSurvey)) + geom_bar() +
    labs(x = "Gender", y = "Student Count") 
```

```{r}
ggplot(data = E, aes(x = gender, fill = ParentschoolSatisfaction)) + geom_bar() +
    labs(x = "Gender", y = "Student Count")
```

```{r}
ggplot(data = E, aes(x = gender, fill = StudentAbsenceDays)) + geom_bar() +
    labs(x = "Gender", y = "Student Count")
```
#Girls has higher 

```{r}

ggplot(data = E, aes(x = gender, fill = Class)) + geom_bar() +
    labs(x = "Gender", y = "Student Count") 
```


#Spanish has worst male:female ratio whereas science, chemistry, english and french have good ratio.

```{r}
ggplot(data = E, aes(x = NationalITy, fill = Class)) + geom_bar() +
    labs(x = "Nationality", y = "Student Count")+theme(axis.text.x = element_text(angle=90, hjust=1))
```
#Jordan and KW(KuwaIT) has highest number of students

```{r}

ggplot(data = E, aes(x = PlaceofBirth, fill = Class)) + geom_bar() +
    labs(x = "PlaceofBirth", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```

```{r}
ggplot(data = E, aes(x = PlaceofBirth, fill = NationalITy)) + geom_bar() +
    labs(x = "PlaceofBirth", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```

```{r}
ggplot(data = E, aes(x = PlaceofBirth, fill = gender)) + geom_bar() +
    labs(x = "PlaceofBirth", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```
```{r}

ggplot(data = E, aes(x = PlaceofBirth, fill = Relation)) + geom_bar() +
    labs(x = "PlaceofBirth", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```
```{r}
ggplot(data = E, aes(x = NationalITy, fill = Relation)) + geom_bar() +
    labs(x = "PlaceofBirth", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```
```{r}
ggplot(data = E, aes(x = NationalITy, fill = ParentAnsweringSurvey)) + geom_bar() +
    labs(x = "NationalITy", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```
```{r}
ggplot(data = E, aes(x = NationalITy, fill = ParentschoolSatisfaction)) + geom_bar() +
    labs(x = "NationalITy", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```


```{r}
ggplot(data = E, aes(x = StageID, fill = gender)) + geom_bar() +
    labs(x = "StageID", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```



```{r}
ggplot(data = E, aes(x = StageID, fill = Topic)) + geom_bar(colour = "black") +
    labs(x = "StageID", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```

```{r}
ggplot(data = E, aes(x = StageID, fill = Semester)) + geom_bar() +
    labs(x = "StageID", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```

```{r}
ggplot(data = E, aes(x = StageID, fill = Relation)) + geom_bar() +
    labs(x = "StageID", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```

```{r}
ggplot(data = E, aes(x = StageID, fill = ParentAnsweringSurvey)) + geom_bar() +
    labs(x = "StageID", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```


```{r}
ggplot(data = E, aes(x = StageID, fill = ParentschoolSatisfaction)) + geom_bar() +
    labs(x = "StageID", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```

```{r}
ggplot(data = E, aes(x = StageID, fill = StudentAbsenceDays)) + geom_bar() +
    labs(x = "StageID", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```

```{r}

ggplot(data = E, aes(x = StageID, fill = Class)) + geom_bar() +
    labs(x = "StageID", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```

```{r}

ggplot(data = E, aes(x = GradeID, fill = StageID)) + geom_bar() +
    labs(x = "GradeID", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1))
```


```{r}
ggplot(data = E, aes(x = SectionID, fill = StageID)) + geom_bar() +
    labs(x = "SectionID", y = "Student Count") +theme(axis.text.x = element_text(angle=0, hjust=1))
```
#Section c has only Middle school and Lowerlevel students

```{r}
ggplot(data = E, aes(x = SectionID, fill = Topic)) + geom_bar(colour = "black") +
    labs(x = "SectionID", y = "Student Count") +theme(axis.text.x = element_text(angle=0, hjust=1))
```
#Section c has only IT and science students.


```{r}
ggplot(data = E, aes(x = Topic, fill = gender)) + geom_bar() +
    labs(x = "Topic", y = "Student Count") +theme(axis.text.x = element_text(angle=90, hjust=1)) 
```
#Spanish has fewest male. Female ratio whereas science, chemistry, english and french have high ratio.

```{r}
ggplot(data = E, aes(x = Topic, fill = Class)) + geom_bar() +
    labs(x = "Topic", y = "Student Count") + ggtitle(label = "Topic Distribution")+theme_grey()+theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face = "bold"))+theme(axis.text.x = element_text(angle=90, hjust=1))
```
#Geology has no low class students


```{r}
 ESummary = E %>%
 # Get the counts
 group_by(Topic, Class) %>%
 summarise(count = n()) %>%
# Get labels and position of labels
 group_by(Topic) %>%
 mutate(Percent = paste0(sprintf("%.1f", count/sum(count) * 100),"%"))

 ggplot(ESummary, aes(x = Topic, y = count)) + 
 geom_bar(aes(fill = Class), stat ="identity", position = 'fill')+ labs(x = "Topic", y = "Student Count")+ ggtitle(label = "Normalized Topic Distribution")+theme_grey()+theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face = "bold"))+theme(axis.text.x = element_text(angle=90, hjust=1))

```
#

```{r}
ggplot(data = E, aes(x = Topic, fill = NationalITy)) + geom_bar(colour = "black") +
    labs(x = "Topic", y = "Student Count") + ggtitle(label = "Topic Distribution")+theme_grey()+theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face = "bold"))+theme(axis.text.x = element_text(angle=90, hjust=1))
```
#IT has most people from KW,Chemistry has least diversity. French has most diversity.

```{r}
ggplot(data = E, aes(x = Topic, fill = StageID)) + geom_bar(colour = "black") +
    labs(x = "Topic", y = "Student Count") + ggtitle(label = "Topic Distribution")+theme_grey()+theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face = "bold"))+theme(axis.text.x = element_text(angle=90, hjust=1))+ scale_y_continuous(breaks = seq(0,100,4))
```
#Geology, biology and chemistry are only in middle school. Fench has the lowest rate of highschool student.


```{r}
ggplot(data = E, aes(x = Topic, fill = SectionID)) + geom_bar(colour = "black") +
    labs(x = "Topic", y = "Student Count") + ggtitle(label = "Topic Distribution")+theme_grey()+theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face = "bold"))+theme(axis.text.x = element_text(angle=90, hjust=1))+ scale_y_continuous(breaks = seq(0,100,4))
```
#Section C only has spanish and IT students.


```{r}
ggplot(data = E, aes(x = Topic, fill = Semester)) + geom_bar(colour = "black") +
    labs(x = "Topic", y = "Student Count") + ggtitle(label = "Topic Distribution")+theme_grey()+theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face = "bold"))+theme(axis.text.x = element_text(angle=90, hjust=1))+ scale_y_continuous(breaks = seq(0,100,4))
```
#IT mostly has students who are in first semester

```{r}
ggplot(data = E, aes(x = Topic, fill = Relation)) + geom_bar(colour = "black") +
    labs(x = "Topic", y = "Student Count") + ggtitle(label = "Topic Distribution")+theme_grey()+theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face = "bold"))+theme(axis.text.x = element_text(angle=90, hjust=1))+ scale_y_continuous(breaks = seq(0,100,4))
```
#Most french students have mom as gaurdian whereas most IT students have fathers as gaurdian.

```{r}
ggplot(data = E, aes(x = ParentAnsweringSurvey, fill = ParentschoolSatisfaction)) + geom_bar(colour = "black") +
    labs(x = "Topic", y = "Student Count") + ggtitle(label = "Topic Distribution")+theme_grey()+theme(plot.title = element_text(hjust = 0.5, lineheight = 0.8, face = "bold"))+theme(axis.text.x = element_text(angle=90, hjust=1))+ scale_y_continuous(breaks = seq(0,500,20))
```
#Most of the parents who aren't satisfied with the school do not answer the survey.


# Summary of Task 1.1:


# Task 1.2. Histogram of numerical values distribution:


```{r}
ggplot(E, aes(x = raisedhands, fill = Class)) +
        geom_histogram(binwidth = 5, colour = "black") +
        scale_x_continuous(name = "Raised Hands",
                           breaks = seq(0, 100, 5),
                           limits=c(0, 100)) + 
        scale_y_continuous(name = "Count") +
        ggtitle("Frequency histogram of Raised Hands") 


```

```{r}
ggplot(data = E, aes(x = raisedhands, color = Class)) + geom_density(size=1)
```



```{r}
ggplot(E, aes(x = VisITedResources, fill = Class)) +
        geom_histogram( binwidth = 5, colour = "black") +
        scale_x_continuous(name = "VisITedResources",
                           breaks = seq(0, 100, 5),
                           limits=c(0, 100)) + 
        scale_y_continuous(name = "Count") +
        ggtitle("Frequency histogram of VisITedResources")


```

```{r}
ggplot(E, aes(x = AnnouncementsView, fill = Class)) +
        geom_histogram( binwidth = 5, colour = "black") +
        scale_x_continuous(name = "AnnouncementsView",
                           breaks = seq(0, 100, 5),
                           limits=c(0, 100)) + 
        scale_y_continuous(name = "Count") +
        ggtitle("Frequency histogram of AnnouncementsView") 


```

```{r}
ggplot(E, aes(x = Discussion, fill = Class)) +
        geom_histogram(binwidth = 5, colour = "black") +
        scale_x_continuous(name = "Discussion",
                           breaks = seq(0, 100, 5),
                           limits=c(0, 100)) + 
        scale_y_continuous(name = "Count") +
        ggtitle("Frequency histogram of Discussion") 


```

# Summary of Task 1.2:



#Task 2. Exporation of the relationships between different features of the students' academic performance datasets

#Task 2.1. Boxplot

```{r}
ggplot(data = E, aes(x = gender, y = raisedhands)) + geom_boxplot()
```


```{r}
ggplot(data = E, aes(x = gender, y = VisITedResources)) + geom_boxplot()

```
```{r}
ggplot(data = E, aes(x = gender, y = AnnouncementsView)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = gender, y = Discussion)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = NationalITy, y = raisedhands)) + geom_boxplot()
```


```{r}
ggplot(data = E, aes(x = NationalITy, y = VisITedResources)) + geom_boxplot()

```
```{r}
ggplot(data = E, aes(x = NationalITy, y = AnnouncementsView)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = NationalITy, y = Discussion)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = StageID, y = raisedhands)) + geom_boxplot()
```


```{r}
ggplot(data = E, aes(x = StageID, y = VisITedResources)) + geom_boxplot()

```
```{r}
ggplot(data = E, aes(x = StageID, y = AnnouncementsView)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = StageID, y = Discussion)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = Topic, y = raisedhands)) + geom_boxplot()
```


```{r}
ggplot(data = E, aes(x = Topic, y = VisITedResources)) + geom_boxplot()

```
```{r}
ggplot(data = E, aes(x = Topic, y = AnnouncementsView)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = Topic, y = Discussion)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = SectionID, y = raisedhands)) + geom_boxplot()
```


```{r}
ggplot(data = E, aes(x = SectionID, y = VisITedResources)) + geom_boxplot()

```
```{r}
ggplot(data = E, aes(x = SectionID, y = AnnouncementsView)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = SectionID, y = Discussion)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = Semester, y = raisedhands)) + geom_boxplot()
```


```{r}
ggplot(data = E, aes(x = Semester, y = VisITedResources)) + geom_boxplot()

```
```{r}
ggplot(data = E, aes(x = Semester, y = AnnouncementsView)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = Semester, y = Discussion)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = Relation, y = raisedhands)) + geom_boxplot()
```


```{r}
ggplot(data = E, aes(x = Relation, y = VisITedResources)) + geom_boxplot()

```
```{r}
ggplot(data = E, aes(x = Relation, y = AnnouncementsView)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = Relation, y = Discussion)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = ParentAnsweringSurvey, y = raisedhands)) + geom_boxplot()
```


```{r}
ggplot(data = E, aes(x = ParentAnsweringSurvey, y = VisITedResources)) + geom_boxplot()

```
```{r}
ggplot(data = E, aes(x = ParentAnsweringSurvey, y = AnnouncementsView)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = ParentAnsweringSurvey, y = Discussion)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = ParentschoolSatisfaction, y = raisedhands)) + geom_boxplot()
```


```{r}
ggplot(data = E, aes(x = ParentschoolSatisfaction, y = VisITedResources)) + geom_boxplot()

```
```{r}
ggplot(data = E, aes(x = ParentschoolSatisfaction, y = AnnouncementsView)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = ParentschoolSatisfaction, y = Discussion)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = StudentAbsenceDays, y = raisedhands)) + geom_boxplot()
```


```{r}
ggplot(data = E, aes(x = StudentAbsenceDays, y = VisITedResources)) + geom_boxplot()

```
```{r}
ggplot(data = E, aes(x = StudentAbsenceDays, y = AnnouncementsView)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = StudentAbsenceDays, y = Discussion)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = Class, y = raisedhands)) + geom_boxplot()
```


```{r}
ggplot(data = E, aes(x = Class, y = VisITedResources)) + geom_boxplot()

```
```{r}
ggplot(data = E, aes(x = Class, y = AnnouncementsView)) + geom_boxplot()
```

```{r}
ggplot(data = E, aes(x = Class, y = Discussion)) + geom_boxplot()
```


#Task 3. Prediction of the students' academic performance. Build prediction model and evaluate the results of the model


```{r}
library(corrplot)
Edu1 <- E
for(i in 1:ncol(Edu1)){
  Edu1[,i]<-as.integer(Edu1[,i])
}
corrplot::corrplot(cor(as.matrix(Edu1)),type = "upper")
```



```{r}
# Preproces: remove the useless features
E1 <- E[,-c(5,6,8)]
E1

```





#Prediction model 1 --- Decision tree
```{r create training and test data 1}
# Decision trees use probability to choose how to split, so here we "seed" a random number generator so our results are always the same.
set.seed(55)


# Split the data into 70% training, 30% test: this means we use 70% of the dataset to build our predictive model. We then use the remaining 30% of data as the unseen data (test) in order to evaluate the predictions.

# Stratified sampling

#TrainingDataIndex <- createDataPartition(E1$Class, p=0.75, list = FALSE)

# Create Training Data 
#trainingData <- E1[TrainingDataIndex,]
#testData <- E1[-TrainingDataIndex,]
ind <- sample(2, nrow(E1), replace=TRUE, prob=c(0.75, 0.25))
trainingData <- E1[ind==1,]
testData <- E1[ind==2,]
```


```{r}
#Use the training data to train a model. Since the "sequece" column is just the accession number for the SWISS-PORT data base, it will not be included in the formula of the tree.
formula <- Class ~ gender + NationalITy + PlaceofBirth + StageID  + Topic + Relation + raisedhands + VisITedResources + AnnouncementsView + Discussion + ParentAnsweringSurvey + ParentschoolSatisfaction + StudentAbsenceDays

E_ctree <- ctree(formula, data = trainingData)
```

```{r, fig.width=20, fig.height=8}
plot(E_ctree)
```


```{r view predictions 1}
tree.predict <- predict(E_ctree, newdata = testData)
confusionMatrix(tree.predict, testData$Class)
```



# Heatmap
```{r}
E_table <- table(tree.predict, testData$Class)
E_melt <- melt(E_table)
names(E_melt) <- c("Prediction", "Reference", "Value")
E_melt$Value <- (E_melt$Value - min(E_melt$Value))/(max(E_melt$Value) - min(E_melt$Value))
E_melt

ggplot(E_melt, aes(x=Reference, y=Prediction, fill=Value)) + geom_tile() + scale_fill_gradient(low = "white",high = "red") + scale_x_discrete(position = "top") + scale_y_discrete(limits = rev(levels(E_melt$Prediction)))
```



#model 2  randomforest

```{r}

rf.model <- randomForest(formula, data = trainingData, importance = TRUE,
                         ntree = 2000, nodesize = 20)

rf.predict <- predict(rf.model, testData)
confusionMatrix(testData$Class, rf.predict)
```

#model 3 Support Vector Machines
```{r}

svm.model <- svm(formula, data = trainingData, kernel = "radial", cost = 10, gamma = 0.15)
svm.predict <- predict(svm.model, testData)
confusionMatrix(testData$Class, svm.predict)
```


#N-folder cross validation for the prediction models above

```{r}
set.seed(55)

ind <- sample(2, nrow(E), replace=TRUE, prob=c(0.75, 0.25))
trainingData <- E[ind==1,]
testData <- E[ind==2,]

formula <- Class ~ gender + NationalITy + PlaceofBirth + StageID +GradeID + SectionID + Topic +Semester + Relation + raisedhands + VisITedResources + AnnouncementsView + Discussion + ParentAnsweringSurvey + ParentschoolSatisfaction + StudentAbsenceDays

TrainingParameters <- trainControl(method = "cv", number = 10)


# train model with randomforest networks
trModel <- train(formula,
                 data = trainingData,
                 method = "ctree",
                 trControl= TrainingParameters,
                 preProcess=c("scale","center"),
                 na.action = na.omit
)

trPredictions <-predict(trModel, testData)
# Create confusion matrix
#trNN <-confusionMatrix(trPredictions, testData$Class)
confusionMatrix(testData$Class, trPredictions)

#print(trNN)

```


```{r}
# estimate variable importance
importance <- varImp(trModel, scale=FALSE)
# summarize importance
print(importance)
# plot importance
plot(importance)
```




```{r}
# train model with randomforest networks
rfModel <- train(formula,
                 data = trainingData,
                  method = "rf",
                  trControl= TrainingParameters,
                  preProcess=c("scale","center")
)

rfPredictions <-predict(rfModel, testData)
# Create confusion matrix
confusionMatrix(rfPredictions, testData$Class)

varImpPlot(rf.model)

```



```{r}
# train model with SVM
SVMModel <- train(formula,
                 data = trainingData,
                  method = "svmRadial", cost = 10, gamma = 0.15,
                  trControl= TrainingParameters,
                  preProcess=c("scale","center"),
                  na.action = na.omit
)

SVMPredictions <-predict(SVMModel, testData)
# Create confusion matrix
confusionMatrix(SVMPredictions, testData$Class)


```



























